# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
Index: misc/win32/env.c
===================================================================
--- misc/win32/env.c	(revision 408977)
+++ misc/win32/env.c	(working copy)
@@ -23,8 +23,7 @@
 #include "apr_errno.h"
 #include "apr_pools.h"
 
-
-#if APR_HAS_UNICODE_FS
+#if APR_HAS_UNICODE_FS && !defined(_WIN32_WCE)
 static apr_status_t widen_envvar_name (apr_wchar_t *buffer,
                                        apr_size_t bufflen,
                                        const char *envvar)
@@ -46,6 +45,9 @@
                                       const char *envvar,
                                       apr_pool_t *pool)
 {
+#if defined(_WIN32_WCE)
+    return APR_ENOTIMPL;
+#else
     char *val = NULL;
     DWORD size;
 
@@ -100,6 +102,7 @@
 
     *value = val;
     return APR_SUCCESS;
+#endif
 }
 
 
@@ -107,6 +110,9 @@
                                       const char *value,
                                       apr_pool_t *pool)
 {
+#if defined(_WIN32_WCE)
+    return APR_ENOTIMPL;
+#else
 #if APR_HAS_UNICODE_FS
     IF_WIN_OS_IS_UNICODE
     {
@@ -138,11 +144,15 @@
 #endif
 
     return APR_SUCCESS;
+#endif
 }
 
 
 APR_DECLARE(apr_status_t) apr_env_delete(const char *envvar, apr_pool_t *pool)
 {
+#if defined(_WIN32_WCE)
+    return APR_ENOTIMPL;
+#else
 #if APR_HAS_UNICODE_FS
     IF_WIN_OS_IS_UNICODE
     {
@@ -166,4 +176,5 @@
 #endif
 
     return APR_SUCCESS;
+#endif
 }
